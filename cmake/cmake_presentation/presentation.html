<!DOCTYPE html>
<!--
  Copyright 2010 Google Inc.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  Original slides: Marcin Wichary (mwichary@google.com)
  Modifications: Ernest Delgado (ernestd@google.com)
                 Alex Russell (slightlyoff@chromium.org)

  landslide modifications: Adam Zapletal (adamzap@gmail.com)
                           Nicolas Perriault (nperriault@gmail.com)
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>CMake and Code Profiling</title>
    <!-- Styles -->
    
    <link rel="stylesheet" media="print" href="file:///home/jbwillis/.local/lib/python2.7/site-packages/landslide/themes/default/css/print.css">
    <link rel="stylesheet" media="screen, projection" href="file:///home/jbwillis/.local/lib/python2.7/site-packages/landslide/themes/default/css/screen.css">
    
    
    <!-- /Styles -->
    <!-- Javascripts -->
    
    <script type="text/javascript" src="file:///home/jbwillis/.local/lib/python2.7/site-packages/landslide/themes/default/js/slides.js"></script>
    
    
    
    <!-- /Javascripts -->
</head>
<body>
  <div id="blank"></div>
  <div class="presentation">
    <div id="current_presenter_notes">
      <div id="presenter_note"></div>
    </div>
    <div class="slides">
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-1">
          <div class="inner">
            
            <header><h1>CMake and Code Profiling</h1></header>
            
            
            <section><p><img alt="" src="https://imgs.xkcd.com/comics/is_it_worth_the_time.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              1/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-2">
          <div class="inner">
            
            <header><h1>Definitions</h1></header>
            
            
            <section><p>These may not be perfect definitions, but they are good enough for now.</p>
<ul>
<li>Executable - the result of compiling a c/c++ program. </li>
<li>Library - a pre-compiled piece of software that your program relies on.<ul>
<li>Static - compiled library code is included in code for final program</li>
<li>Shared - compiled library code is linked in during the execution of the program</li>
</ul>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              2/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-3">
          <div class="inner">
            
            <header><h1>Make vs CMake - A Simple Example</h1></header>
            
            
            <section><p>We will use the following three files for a simple hello world program <a href="http://www.cs.colby.edu/maxwell/courses/tutorials/maketutor/">ref</a>. </p>
<p><strong>main.c</strong></p>
<div class="highlight"><pre><span></span><span class="lineno">1 </span><span class="cp">#include</span> <span class="cpf">&quot;helloworld.h&quot;</span><span class="cp"></span>
<span class="lineno">2 </span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">3 </span>    <span class="n">helloWorld</span><span class="p">();</span>
<span class="lineno">4 </span>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">5 </span><span class="p">}</span>
</pre></div>

<p><strong>helloworld.c</strong></p>
<div class="highlight"><pre><span></span><span class="lineno">1 </span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="lineno">2 </span><span class="cp">#include</span> <span class="cpf">&quot;helloworld.h&quot;</span><span class="cp"></span>
<span class="lineno">3 </span><span class="kt">void</span> <span class="nf">helloWorld</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">4 </span>    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello World!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="lineno">5 </span><span class="p">}</span>
</pre></div>

<p><strong>helloworld.h</strong></p>
<div class="highlight"><pre><span></span><span class="lineno">1 </span><span class="cp">#ifndef HELLO_WORLD_H_</span>
<span class="lineno">2 </span><span class="cp">#define HELLO_WORLD_H_</span>
<span class="lineno">3 </span><span class="kt">void</span> <span class="nf">helloWorld</span><span class="p">();</span>
<span class="lineno">4 </span><span class="cp">#endif </span><span class="cm">/* HELLO_WORLD_H_ */</span><span class="cp"></span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              3/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-4">
          <div class="inner">
            
            <header><h1>Simple Example - File Org</h1></header>
            
            
            <section><p>These files are arranged in the following directory structure, where * is either Make or CMake. </p>
<pre><code>simple_example_*/
├── build
├── include
│   └── helloworld.h
└── src
    ├── helloworld.c
    └── main.c
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              4/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-5">
          <div class="inner">
            
            <header><h1>Compiling on command line</h1></header>
            
            
            <section><p>When compiling this program, you might run:</p>
<div class="highlight"><pre><span></span><span class="lineno">1 </span>gcc -o build/main src/main.c src/helloworld.c -Iinclude/
</pre></div>

<ul>
<li>Quick for small programs</li>
<li>No documented/repeatable method for compiling</li>
<li>Recompiles all of the files, regardless of changes</li>
</ul>
<p>This works fine for a program consisting of a couple of files, but quickly becomes unweildy. It requires you to recall the exact command you are using when compiling, and it recompiles all of the files, regardless of if they have been changed. Recompiling unchanged files becomes a significant waste of time on any but the the simplest projects.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              5/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-6">
          <div class="inner">
            
            <header><h1>Makefiles</h1></header>
            
            
            <section><ul>
<li>Native UNIX system for building programs</li>
<li>Compares the timestamps of the source files with those of the compiled object files, recompiling if the source file timestamp is more recent</li>
</ul>
<p>Here's about the simplest makefile that could be used to compile our example:</p>
<div class="highlight"><pre><span></span><span class="lineno">1 </span><span class="nf">hellomake</span><span class="o">:</span> <span class="n">main</span>.<span class="n">c</span> <span class="n">lib</span>/<span class="n">helloworld</span>/<span class="n">helloworld</span>.<span class="n">c</span>
<span class="lineno">2 </span>    gcc -o build/main src/main.c <span class="se">\</span>
<span class="lineno">3 </span>    lib/helloworld/helloworld.c -Ilib/helloworld/
</pre></div>

<ul>
<li>Easy to recompile</li>
<li>Not very easy to extend</li>
<li>Still recompiles everything every time</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              6/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-7">
          <div class="inner">
            
            <header><h1>Makefiles</h1></header>
            
            
            <section><div class="highlight"><pre><span></span><span class="lineno"> 1 </span><span class="nv">CC</span><span class="o">=</span>gcc
<span class="lineno"> 2 </span><span class="nv">IDIR</span><span class="o">=</span>include
<span class="lineno"> 3 </span><span class="nv">CFLAGS</span><span class="o">=</span>-I<span class="k">$(</span>IDIR<span class="k">)</span>
<span class="lineno"> 4 </span><span class="nv">SDIR</span><span class="o">=</span>src
<span class="lineno"> 5 </span><span class="nv">BDIR</span><span class="o">=</span>build
<span class="lineno"> 6 </span>
<span class="lineno"> 7 </span><span class="nv">_DEPS</span><span class="o">=</span>helloworld.h
<span class="lineno"> 8 </span><span class="nv">_OBJ</span> <span class="o">=</span> helloworld.o main.o
<span class="lineno"> 9 </span><span class="nv">DEPS</span><span class="o">=</span><span class="k">$(</span>patsubst %,<span class="k">$(</span>IDIR<span class="k">)</span>/%,<span class="k">$(</span>_DEPS<span class="k">))</span>
<span class="lineno">10 </span><span class="nv">OBJ</span> <span class="o">=</span> <span class="k">$(</span>patsubst %,<span class="k">$(</span>BDIR<span class="k">)</span>/%,<span class="k">$(</span>_OBJ<span class="k">))</span>
<span class="lineno">11 </span>
<span class="lineno">12 </span><span class="nf">$(BDIR)/%.o</span><span class="o">:</span> <span class="k">$(</span><span class="nv">SDIR</span><span class="k">)</span>/%.<span class="n">c</span> <span class="k">$(</span><span class="nv">DEPS</span><span class="k">)</span>
<span class="lineno">13 </span>    <span class="k">$(</span>CC<span class="k">)</span> -c -o <span class="nv">$@</span> $&lt; <span class="k">$(</span>CFLAGS<span class="k">)</span>
<span class="lineno">14 </span>
<span class="lineno">15 </span><span class="nf">main</span><span class="o">:</span> <span class="k">$(</span><span class="nv">OBJ</span><span class="k">)</span>
<span class="lineno">16 </span>    <span class="k">$(</span>CC<span class="k">)</span> -o <span class="k">$(</span>BDIR<span class="k">)</span>/<span class="nv">$@</span> $^ <span class="k">$(</span>CFLAGS<span class="k">)</span>
<span class="lineno">17 </span>
<span class="lineno">18 </span><span class="nf">.PHONY</span><span class="o">:</span> <span class="n">clean</span>
<span class="lineno">19 </span><span class="nf">clean</span><span class="o">:</span>
<span class="lineno">20 </span>    rm -f <span class="k">$(</span>ODIR<span class="k">)</span>/*.o *~ core <span class="k">$(</span>IDIR<span class="k">)</span>/*~
</pre></div>

<ul>
<li>Add additional files by modifying the <code>_DEPS</code> and <code>_OBJ</code> lines</li>
<li>The <code>%.o</code> rule compiles each <code>.c</code> file into its own object files, which are then linked together at the end in the <code>main</code> rule. </li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              7/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-8">
          <div class="inner">
            
            <header><h1>Pros and Cons of Make</h1></header>
            
            
            <section><ul>
<li>Pros          <ul>
<li>Comes with any unix-like operating system </li>
<li>Recompiles only changed files </li>
<li>Can handle complicated build configurations </li>
</ul>
</li>
<li>Cons          <ul>
<li>Not compatible with non-unix systems</li>
<li>Timestamp based method is susceptible to errors, requiring a <code>make clean</code> to fix them.</li>
<li>Somewhat archaic language takes time to get used to </li>
</ul>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              8/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-9">
          <div class="inner">
            
            <header><h1>CMake</h1></header>
            
            
            <section><p>From the website: </p>
<p>"CMake is an extensible, open-source system that manages the build process in an operating system and in a compiler-independent manner. Unlike many cross-platform systems, CMake is designed to be used in conjunction with the native build environment."</p>
<p>Put simply, <strong>CMake is a program that generates makefiles (lots of them).</strong></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              9/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-10">
          <div class="inner">
            
            <header><h1>File Organization</h1></header>
            
            
            <section><p>Continuing our simple example, for CMake, we need to create two <code>CMakeLists.txt</code> files. One goes in the root of the project and the other in the src directory.</p>
<pre><code>simple_example_CMake/
├── build
├── CMakeLists.txt
├── include
│   └── helloworld.h
└── src
    ├── CMakeLists.txt
    ├── helloworld.c
    └── main.c
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              10/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-11">
          <div class="inner">
            
            <header><h1>CMakeLists</h1></header>
            
            
            <section><p><strong>CMakeLists.txt</strong></p>
<div class="highlight"><pre><span></span><span class="lineno">1 </span><span class="nb">cmake_minimum_required</span> <span class="p">(</span><span class="s">VERSION</span> <span class="s">2.8.3</span><span class="p">)</span>
<span class="lineno">2 </span><span class="nb">project</span> <span class="p">(</span><span class="s">Simple_Example</span><span class="p">)</span>
<span class="lineno">3 </span>
<span class="lineno">4 </span><span class="nb">include_directories</span><span class="p">(</span><span class="s2">&quot;${PROJECT_SOURCE_DIR}/include&quot;</span><span class="p">)</span>
<span class="lineno">5 </span><span class="nb">add_subdirectory</span><span class="p">(</span><span class="s">src</span><span class="p">)</span>
</pre></div>

<p><strong>src/CMakeLists.txt</strong></p>
<div class="highlight"><pre><span></span><span class="lineno">1 </span><span class="nb">add_library</span><span class="p">(</span><span class="s">helloworld</span> <span class="s">STATIC</span> <span class="s">helloworld.c</span><span class="p">)</span>
<span class="lineno">2 </span><span class="nb">add_executable</span><span class="p">(</span><span class="s">main</span> <span class="s">main.c</span><span class="p">)</span>
<span class="lineno">3 </span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">main</span> <span class="s">helloworld</span><span class="p">)</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              11/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_code slide-12">
          <div class="inner">
            
            
            <section><p>CMake generates a lot of files, so it is common to create a <code>build</code> directory, and to run <code>cmake</code> from within that directory. In addition, since it is really just generating native build files, you must run <code>make</code> after running <code>cmake.</code> To compile the simple example:</p>
<div class="highlight"><pre><span></span><span class="lineno">1 </span>$ <span class="nb">cd</span> build/
<span class="lineno">2 </span>$ cmake ..
<span class="lineno">3 </span>$ make
</pre></div>

<p>Then to run <code>main</code>:</p>
<div class="highlight"><pre><span></span><span class="lineno">1 </span>$ build/src/main
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              12/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_notes slide-13">
          <div class="inner">
            
            <header><h1>Building in ROS - Catkin</h1></header>
            
            
            <section><p class="notes">This assumes you are already familar with the basic structure of a catkin workspace, and how to build a set of ros packages.</p>
<h2>Catkin</h2>
<p><!--<img alt="" src="https://en.wikipedia.org/wiki/Catkin#/media/File:Willow_catkin_2_aka.jpg" title="Catkins on a willow" />-->
<img alt="" src="file:///home/jbwillis/magicc/cmake_presentation/catkin_300.jpg" title="https://en.wikipedia.org/wiki/Catkin#/media/File:Willow_catkin_2_aka.jpg" /></p>
<ul>
<li>
<p>Essentially a wrapper for CMake that does some ros-specifiic things before calling cmake.</p>
</li>
<li>
<p>When you run <code>catkin_make</code> in an empty catkin workspace (<code>~/catkin_ws</code>), <a href="http://wiki.ros.org/catkin/commands/catkin_make">here is what is actually happening</a></p>
<p>!bash
$ cd ~/catkin_ws
$ cd src
$ catkin_init_workspace
$ cd ..
$ mkdir build
$ cd build
$ cmake ../src -DCMAKE_INSTALL_PREFIX=../install -DCATKIN_DEVEL_PREFIX=../devel
$ make</p>
</li>
</ul>
<p class="notes">The <code>catkin_init_workspace</code> command creates the top level CMakelists.txt as a symlink to a generic one found in the ros installation. Note that at the end, <code>cmake</code> is invoked on the <code>src</code> directory, and then <code>make</code> is called from within <code>build</code>.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              13/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-14">
          <div class="inner">
            
            <header><h1>CMake - more depth</h1></header>
            
            
            <section><p>There are countless resources on CMake online. To give a good general overview of using CMake with ROS, we will use the <code>CMakeLists.txt</code> file from <a href="http://github.com/byu-magicc/roscopter/">roscopter</a>. </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              14/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide has_notes slide-15">
          <div class="inner">
            
            <header><h1>Improving the build - CCache</h1></header>
            
            
            <section><ul>
<li>make (and thus cmake) uses file timestamps to determine when it needs to recompile a file. </li>
<li>ccmake hashes the source file and compiler arguments and stores the compiled object files in a cache. </li>
<li>Installing ccmake reduced the time it took for a clean recompile of roscoptor from ~50 sec to ~20 sec, including the time cmake spends regenerating files. </li>
</ul>
<p class="notes">There are times when files have not changed, but the timestamp has (such as on a git checkout). Additionally, on a <code>make clean; make</code> many of the built files will not change, but on a large project you will wait a long time for them to rebuild. Finally, if you are working on multiple copies of the same project (such as rosflight in roscopter and rosplane), you might be recompiling much of the same code. </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              15/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-16">
          <div class="inner">
            
            <header><h1>Installing CCache</h1></header>
            
            
            <section><ul>
<li>Use the <a href="https://github.com/ccache/ccache/blob/master/doc/INSTALL-from-release-archive.md">instructions!</a></li>
<li>I used their most recent archive (3.7.1) </li>
<li>
<p>ccache forms an "invisible" layer on top of the regular compiler. Create symbolic links to ccache as they describe in their instructions. Catkin automatically sets CMake to use <code>/usr/bin/c++</code> so, you need to link that one too.</p>
<p>!bash
/usr/local/bin/c++ -&gt; /usr/local/bin/ccache
/usr/local/bin/cc -&gt; /usr/local/bin/ccache
/usr/local/bin/g++ -&gt; /usr/local/bin/ccache
/usr/local/bin/gcc -&gt; /usr/local/bin/ccache</p>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              16/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-17">
          <div class="inner">
            
            <header><h1>Improving the build - Ninja</h1></header>
            
            
            <section><p><a href="https://ninja-build.org/">Ninja</a> is intended to speed up incremental builds. CMake (and thus Catkin) has built in support for generating ninja buildfiles. To run <code>catkin_make</code> with ninja, just pass the <code>--use-ninja</code> flag.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              17/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-18">
          <div class="inner">
            
            <header><h1>References</h1></header>
            
            
            <section><ul>
<li><a href="http://wiki.ros.org/catkin/conceptual_overview">ROS official justification for Catkin</a></li>
<li><a href="http://wiki.ros.org/catkin/commands/catkin_make">catkin_make command description page</a></li>
<li><a href="http://wiki.ros.org/catkin/CMakeLists.txt">Catkin CMakeLists.txt explanation</a></li>
<li><a href="http://wiki.ros.org/catkin/workspaces">Catkin workspaces explanation</a></li>
<li><a href="http://www.cs.colby.edu/maxwell/courses/tutorials/maketutor/">Makefile tutorial by Bruce Maxwell</a> </li>
<li><a href="https://learning.oreilly.com/library/view/cmake-cookbook/9781788470711/?ar">CMake Cookbook (Free from BYU Library)</a><ul>
<li><a href="https://github.com/PacktPublishing/CMake-Cookbook">Example Code git repo</a></li>
</ul>
</li>
<li><a href="https://ccache.dev/">ccache website</a></li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              18/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-19">
          <div class="inner">
            
            <header><h1>Code Profiling</h1></header>
            
            
            <section><p>"In software engineering, profiling ("program profiling", "software profiling") is a form of <strong>dynamic program analysis</strong> that measures, for example, the space (memory) or time complexity of a program, the usage of particular instructions, or the frequency and duration of function calls. Most commonly, <strong>profiling information serves to aid program optimization</strong>."</p>
<p>From <a href="https://en.wikipedia.org/wiki/Profiling_(computer_programming)">Wikipedia</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              19/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-20">
          <div class="inner">
            
            
            <section><p><img alt="" src="https://imgs.xkcd.com/comics/optimization.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              20/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-21">
          <div class="inner">
            
            <header><h1>Profiling Methods</h1></header>
            
            
            <section><ul>
<li><strong>Event-based</strong>: For interpreted languages such as python or for languages run by a virtual machine (java), it is possible to use the superstructure running the program to monitor the running program.</li>
<li><strong>Statistical</strong>: These profilers sample the running program, creating a statistical approximation of its runtime performance.<ul>
<li>Pros: Not very intrusive</li>
<li>Cons: Statistical, so may not capture true program behavior</li>
</ul>
</li>
<li><strong>Instrumentation</strong>: This involves adding (automatically or manually) code to the program that measures and reports characteristics of the program as it runs.<ul>
<li>Pros: Highly granular, can catch many types of problems</li>
<li>Cons: Can significantly increase program runtime (Valgrind runs programs to run 20-30 times slower), may introduce new bugs (Heisenbugs!)</li>
</ul>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              21/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-22">
          <div class="inner">
            
            <header><h1>Common Tools</h1></header>
            
            
            <section><h2><a href="https://sourceware.org/binutils/docs/gprof/">gprof</a></h2>
<ul>
<li>Uses a combination of statistical and instrumentation based approach. </li>
<li>When compiling with <code>gcc</code> the <code>-pg</code> flag is used to add in gprof. </li>
<li>Seems to be the standard GNU profiling tools. </li>
<li>Major limitation: Does not support multi-threaded applications, shared libraries and kernel profiling.</li>
</ul>
<h2><a href="https://oprofile.sourceforge.io/about/">oprofile</a></h2>
<ul>
<li>System-wide profiler, requiring no special recompilation</li>
<li>Supports debugging of all code, including kernel, multi-threaded, and shared libraries</li>
<li>Requires root permissions</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              22/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-23">
          <div class="inner">
            
            <header><h1>Common Tools</h1></header>
            
            
            <section><h2><a href="http://www.valgrind.org/">valgrind</a></h2>
<ul>
<li>Instruments the program at runtime, using a sort of virtual machine to simulate the program.</li>
<li>Can produce a call graph using <code>callgrind</code></li>
<li>Also can help find memory leaks and other bugs</li>
</ul>
<h2><a href="https://github.com/gperftools/gperftools">gperftools</a></h2>
<ul>
<li>Primarily a fast implementation of <code>malloc</code>, but it also includes a CPU profiler, heap profiler, and memory leak detector.</li>
<li>Supports statitistical (fast) profiling of multi-threaded programs.</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              23/24
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: presentation.md -->
      <div class="slide-wrapper">
        <div class="slide slide-24">
          <div class="inner">
            
            <header><h1>Resources</h1></header>
            
            
            <section><ul>
<li><a href="http://gernotklingler.com/blog/gprof-valgrind-gperftools-evaluation-tools-application-level-cpu-profiling-linux/">Comparison of <strong>gperftools,</strong> <strong>Valgrind,</strong> and <strong>gprof</strong></a></li>
<li><a href="http://wiki.ros.org/roslaunch/Tutorials/Profiling%20roslaunch%20nodes">Introduction to OProfile</a></li>
<li><a href="http://wiki.ros.org/roslaunch/Tutorials/Profiling%20roslaunch%20nodes">Profiling ROS nodes</a></li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="presentation.md">presentation.md</a>
            </aside>
            
            <aside class="page_number">
              24/24
            </aside>
          </footer>
        </div>
      </div>
      
    </div>
  </div>
  
  <div id="toc" class="sidebar hidden">
    <h2>Table of Contents</h2>
    <table>
      <caption>Table of Contents</caption>
      
      <tr id="toc-row-1">
        <th><a href="#slide1">CMake and Code Profiling</a></th>
        <td><a href="#slide1">1</a></td>
      </tr>
      
      
      <tr id="toc-row-2">
        <th><a href="#slide2">Definitions</a></th>
        <td><a href="#slide2">2</a></td>
      </tr>
      
      
      <tr id="toc-row-3">
        <th><a href="#slide3">Make vs CMake - A Simple Example</a></th>
        <td><a href="#slide3">3</a></td>
      </tr>
      
      
      <tr id="toc-row-4">
        <th><a href="#slide4">Simple Example - File Org</a></th>
        <td><a href="#slide4">4</a></td>
      </tr>
      
      
      <tr id="toc-row-5">
        <th><a href="#slide5">Compiling on command line</a></th>
        <td><a href="#slide5">5</a></td>
      </tr>
      
      
      <tr id="toc-row-6">
        <th><a href="#slide6">Makefiles</a></th>
        <td><a href="#slide6">6</a></td>
      </tr>
      
      
      <tr id="toc-row-7">
        <th><a href="#slide7">Makefiles</a></th>
        <td><a href="#slide7">7</a></td>
      </tr>
      
      
      <tr id="toc-row-8">
        <th><a href="#slide8">Pros and Cons of Make</a></th>
        <td><a href="#slide8">8</a></td>
      </tr>
      
      
      <tr id="toc-row-9">
        <th><a href="#slide9">CMake</a></th>
        <td><a href="#slide9">9</a></td>
      </tr>
      
      
      <tr id="toc-row-10">
        <th><a href="#slide10">File Organization</a></th>
        <td><a href="#slide10">10</a></td>
      </tr>
      
      
      <tr id="toc-row-11">
        <th><a href="#slide11">CMakeLists</a></th>
        <td><a href="#slide11">11</a></td>
      </tr>
      
      
      <tr id="toc-row-12">
        <th><a href="#slide12">-</a></th>
        <td><a href="#slide12">12</a></td>
      </tr>
      
      
      <tr id="toc-row-13">
        <th><a href="#slide13">Building in ROS - Catkin</a></th>
        <td><a href="#slide13">13</a></td>
      </tr>
      
      
      <tr id="toc-row-14">
        <th><a href="#slide14">CMake - more depth</a></th>
        <td><a href="#slide14">14</a></td>
      </tr>
      
      
      <tr id="toc-row-15">
        <th><a href="#slide15">Improving the build - CCache</a></th>
        <td><a href="#slide15">15</a></td>
      </tr>
      
      
      <tr id="toc-row-16">
        <th><a href="#slide16">Installing CCache</a></th>
        <td><a href="#slide16">16</a></td>
      </tr>
      
      
      <tr id="toc-row-17">
        <th><a href="#slide17">Improving the build - Ninja</a></th>
        <td><a href="#slide17">17</a></td>
      </tr>
      
      
      <tr id="toc-row-18">
        <th><a href="#slide18">References</a></th>
        <td><a href="#slide18">18</a></td>
      </tr>
      
      
      <tr id="toc-row-19">
        <th><a href="#slide19">Code Profiling</a></th>
        <td><a href="#slide19">19</a></td>
      </tr>
      
      
      <tr id="toc-row-20">
        <th><a href="#slide20">-</a></th>
        <td><a href="#slide20">20</a></td>
      </tr>
      
      
      <tr id="toc-row-21">
        <th><a href="#slide21">Profiling Methods</a></th>
        <td><a href="#slide21">21</a></td>
      </tr>
      
      
      <tr id="toc-row-22">
        <th><a href="#slide22">Common Tools</a></th>
        <td><a href="#slide22">22</a></td>
      </tr>
      
      
      <tr id="toc-row-23">
        <th><a href="#slide23">Common Tools</a></th>
        <td><a href="#slide23">23</a></td>
      </tr>
      
      
      <tr id="toc-row-24">
        <th><a href="#slide24">Resources</a></th>
        <td><a href="#slide24">24</a></td>
      </tr>
      
      
    </table>
  </div>
  
  <div id="help" class="sidebar hidden">
    <h2>Help</h2>
    <table>
      <caption>Help</caption>
      <tr>
        <th>Table of Contents</th>
        <td>t</td>
      </tr>
      <tr>
        <th>Exposé</th>
        <td>ESC</td>
      </tr>
      <tr>
        <th>Full screen slides</th>
        <td>e</td>
      </tr>
      <tr>
        <th>Presenter View</th>
        <td>p</td>
      </tr>
      <tr>
        <th>Source Files</th>
        <td>s</td>
      </tr>
      <tr>
        <th>Slide Numbers</th>
        <td>n</td>
      </tr>
      <tr>
        <th>Toggle screen blanking</th>
        <td>b</td>
      </tr>
      <tr>
        <th>Show/hide slide context</th>
        <td>c</td>
      </tr>
      <tr>
        <th>Notes</th>
        <td>2</td>
      </tr>
      <tr>
        <th>Help</th>
        <td>h</td>
      </tr>
    </table>
  </div>
  <script>main()</script>
</body>
</html>